B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.5                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
desihn<-c(1/5,1/5)
t3<- 1-(2*t1+2*t2)
t1<-design[1]
design<-c(1/5,1/5)
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
t3
t1
t2
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.25,0.25,0.25,0.25)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
x
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.341,0.159,0.159,0.341)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.341,0.159,0.159,0.341)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
psi<- function(design,theta,n,sigma,q)
{
t1<-design[1]
t2<-design[2]
t3<- 1-(2*t1+2*t2)
de12 <- ((theta[1]-theta[2])*n)/sigma
de23 <- ((theta[2]-theta[3])*n)/sigma
de34 <- ((theta[3]-theta[4])*n)/sigma
de45 <- ((theta[4]-theta[5])*n)/sigma
a12 <- t1*t3
b12 <- (t1+t2)*(t2+t3)
rho12 <- -sqrt(a12/b12)
rho13 <- 0
rho14<- 0
a23 <- t2*t2
b23 <- (t2+t3)*(t3+t2)
rho23 <- -sqrt(a23/b23)
rho24 <- 0
a34 <- t3*t1
b34 <- (t3+t2)*(t2+t1)
rho34 <- -sqrt(a34/b34)
theta1 <- (sqrt((t1*t2)/(t1 + t2)))*de12
theta2 <- (sqrt((t2*t3)/(t2 + t3)))*de23
theta3 <- (sqrt((t3*t2)/(t3 + t2)))*de34
theta4 <- (sqrt((t2*t1)/(t2 + t1)))*de45
m <- c(theta1,theta2,theta3,theta4)
S <-  rbind(c(1,rho12,rho13,rho14),c(rho12,1,rho23,rho24),c(rho13,rho23,1,rho34),c(rho14,rho24,rho34,1))
lw1 <- c(-q,-q,-q,-q)
up1 <- c(q,q,q,q)
return(-(1-pmvnorm(mean=m, sigma=S, lower=lw1, upper=up1)))
return(y[1])
}
# Function for calculating the average power B
B<- function(design,theta_vals,prob_vals,n,sigma,q){
s <- 0
for (i in 1:length(prob_vals)){
s <- s + prob_vals[i]* psi(design,theta_vals[i,],n,sigma,q)
}
ret_val<-s
return(ret_val[1])
}
N <- 180                    # Total No. of subjects
n <- sqrt(N)
sigma <- 1
al <- 0.05/8               # significance level alpha
q <- qnorm(1-al)           # critical value
del<-0.4                   # delta
K<-5
# Initialization of B_pi
h_grid_space <- 0.2       # grid length
H<- seq(0, 1, by=h_grid_space)     # grid vector
theta_vals_l <-matrix(0, K-1, K)
for (i in 1:K-1){
for (j in 1:i){
theta_vals_l[i,j] <- del
}}
p<-c(0.341,0.159,0.159,0.341)
x<-c(1/5,1/5)
B(x,theta_vals_l,p,n,sigma,q)
x
p
theta_vals_l
